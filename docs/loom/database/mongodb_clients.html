<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>mongodb_clients.py</title>
  <link rel="stylesheet" href="../../pycco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>mongodb_clients.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bson.objectid</span> <span class="kn">import</span> <span class="n">ObjectId</span>
<span class="kn">from</span> <span class="nn">motor.core</span> <span class="kn">import</span> <span class="n">AgnosticClient</span><span class="p">,</span> <span class="n">AgnosticDatabase</span><span class="p">,</span> <span class="n">AgnosticCollection</span>
<span class="kn">from</span> <span class="nn">pymongo.results</span> <span class="kn">import</span> <span class="n">UpdateResult</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">class</span> <span class="nc">LoomMongoDBClient</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mongodb_client_class</span><span class="p">,</span> <span class="n">db_name</span><span class="o">=</span><span class="s1">&#39;inkweaver&#39;</span><span class="p">,</span> <span class="n">db_host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">db_port</span><span class="o">=</span><span class="mi">27017</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_host</span> <span class="o">=</span> <span class="n">db_host</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_port</span> <span class="o">=</span> <span class="n">db_port</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="o">=</span> <span class="n">mongodb_client_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_database</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="p">,</span> <span class="n">db_name</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">host</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_host</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">port</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_port</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AgnosticClient</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">database</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AgnosticDatabase</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_database</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">users</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AgnosticCollection</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">users</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stories</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AgnosticCollection</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">stories</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sections</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AgnosticCollection</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">sections</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">wikis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AgnosticCollection</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">wikis</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">segments</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AgnosticCollection</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">segments</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pages</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AgnosticCollection</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">pages</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">headings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AgnosticCollection</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">headings</span>

    <span class="n">async</span> <span class="k">def</span> <span class="nf">drop_database</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">drop_database</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <h6></h6>
<p>User Methods</p>
<h6></h6>
<p>Inserts a new user to the users collection.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">async</span> <span class="k">def</span> <span class="nf">create_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                          <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                          <span class="n">password_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                          <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                          <span class="n">email</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                          <span class="n">bio</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                          <span class="n">avatar</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                          <span class="n">_id</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ObjectId</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <p>Adds a new user to the <code>users</code> collection. Stories and wikis are
initialized to empty lists. Unless <code>_id</code> is provided, a random BSON
ObjectId will be assigned to <code>_id</code>.</p>
<p>Args:
    username: The username of the user.
    password_hash: The hash of the user's password.
    name: The full name of the user.
    email: The email address of the user.
    bio: A short description of the user.
    avatar (str): Base-64 encoded image user chooses to identify
        themselves with.
    _id (ObjectId): <code>_id</code> is optional, but if provided, will create a
        user with the provided ObjectId.</p>
<p>Returns:
    The ObjectId that is associated with the newly created user. If
    <code>_id</code> was provided, <code>_id</code> will be returned. Otherwise, a randomly
    generated BSON ObjectId will be returned.</p>
<p>TODO: Implement statistics.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">user</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;username&#39;</span><span class="p">:</span>      <span class="n">username</span><span class="p">,</span>
            <span class="s1">&#39;password_hash&#39;</span><span class="p">:</span> <span class="n">password_hash</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span>          <span class="n">name</span><span class="p">,</span>
            <span class="s1">&#39;email&#39;</span><span class="p">:</span>         <span class="n">email</span><span class="p">,</span>
            <span class="s1">&#39;bio&#39;</span><span class="p">:</span>           <span class="n">bio</span><span class="p">,</span>
            <span class="s1">&#39;avatar&#39;</span><span class="p">:</span>        <span class="n">avatar</span><span class="p">,</span>
            <span class="s1">&#39;stories&#39;</span><span class="p">:</span>       <span class="nb">list</span><span class="p">(),</span>
            <span class="s1">&#39;wikis&#39;</span><span class="p">:</span>         <span class="nb">list</span><span class="p">(),</span>
            <span class="s1">&#39;statistics&#39;</span><span class="p">:</span>    <span class="bp">None</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">user</span><span class="p">[</span><span class="s1">&#39;_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_id</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">insert_one</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">inserted_id</span>

    <span class="n">async</span> <span class="k">def</span> <span class="nf">get_password_hash_for_username</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p>:param user_id:
:return:</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">user</span> <span class="o">=</span> <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">find_one</span><span class="p">(</span>
            <span class="nb">filter</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="n">username</span><span class="p">},</span>
            <span class="n">projection</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;password_hash&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">user</span><span class="p">[</span><span class="s1">&#39;password_hash&#39;</span><span class="p">]</span>

    <span class="n">async</span> <span class="k">def</span> <span class="nf">get_user_id_for_username</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ObjectId</span><span class="p">:</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">find_one</span><span class="p">(</span>
            <span class="nb">filter</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="n">username</span><span class="p">},</span>
            <span class="n">projection</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">user</span><span class="p">[</span><span class="s1">&#39;_id&#39;</span><span class="p">]</span>

    <span class="n">async</span> <span class="k">def</span> <span class="nf">set_user_password_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">password_hash</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_user_field</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="s1">&#39;password_hash&#39;</span><span class="p">,</span> <span class="n">password_hash</span><span class="p">)</span>

    <span class="n">async</span> <span class="k">def</span> <span class="nf">set_user_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_user_field</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

    <span class="n">async</span> <span class="k">def</span> <span class="nf">set_user_email</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">email</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_user_field</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">)</span>

    <span class="n">async</span> <span class="k">def</span> <span class="nf">set_user_bio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">bio</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_user_field</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="s1">&#39;bio&#39;</span><span class="p">,</span> <span class="n">bio</span><span class="p">)</span>

    <span class="n">async</span> <span class="k">def</span> <span class="nf">set_user_avatar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">avatar</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_user_field</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="s1">&#39;avatar&#39;</span><span class="p">,</span> <span class="n">avatar</span><span class="p">)</span>

    <span class="n">async</span> <span class="k">def</span> <span class="nf">set_user_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">result</span><span class="p">:</span> <span class="n">UpdateResult</span> <span class="o">=</span> <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">update_one</span><span class="p">({</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;$set&#39;</span><span class="p">:</span> <span class="p">{</span><span class="n">field</span><span class="p">:</span> <span class="n">value</span><span class="p">}})</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">matched_count</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <p>TODO: Handle this case.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">pass</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">modified_count</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <p>TODO: Handle this case.
Grabs the preferences for the provided user.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">pass</span>

    <span class="n">async</span> <span class="k">def</span> <span class="nf">get_user_preferences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <p>Finds the user in the database and extracts the fields specified by
The LAW Protocol.</p>
<p>Args:
    user_id: BSON ObjectId of user to query for.</p>
<p>Returns:
    A filtered document of the user. According to the LAW Protocol,
    returns <code>username</code>, <code>name</code>, <code>email</code>, <code>bio</code>, and <code>avatar</code> of the
    user.</p>
<p>Grabs the ObjectIds of the user's stories.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">result</span> <span class="o">=</span> <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">find_one</span><span class="p">(</span>
            <span class="nb">filter</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">},</span>
            <span class="n">projection</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;_id&#39;</span><span class="p">:</span>      <span class="mi">0</span><span class="p">,</span>
                <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;name&#39;</span><span class="p">:</span>     <span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;email&#39;</span><span class="p">:</span>    <span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;bio&#39;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;avatar&#39;</span><span class="p">:</span>   <span class="mi">1</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="n">async</span> <span class="k">def</span> <span class="nf">get_user_story_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">ObjectId</span><span class="p">]:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <p>Args:
    user_id: BSON ObjectId of user to query for.</p>
<p>Returns:
    A list of the BSON ObjectIds of the <code>stories</code> that the user has
    access to.</p>
<p>Grabs the ObjectIds of the user's wikis.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">result</span> <span class="o">=</span> <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">find_one</span><span class="p">(</span>
            <span class="nb">filter</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">},</span>
            <span class="n">projection</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;_id&#39;</span><span class="p">:</span>     <span class="mi">0</span><span class="p">,</span>
                <span class="s1">&#39;stories&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;stories&#39;</span><span class="p">]</span>

    <span class="n">async</span> <span class="k">def</span> <span class="nf">get_user_wiki_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">ObjectId</span><span class="p">]:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <p>Args:
    user_id: BSON ObjectId of user to query for.</p>
<p>Returns:
    A list of the BSON ObjectIds of the <code>wikis</code> that the user has
    access to.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">result</span> <span class="o">=</span> <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">find_one</span><span class="p">(</span>
            <span class="nb">filter</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">},</span>
            <span class="n">projection</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;_id&#39;</span><span class="p">:</span>   <span class="mi">0</span><span class="p">,</span>
                <span class="s1">&#39;wikis&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;wikis&#39;</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <h6></h6>
<p>Story Methods</p>
<h6></h6>
<p>Inserts a new story to the stories collection.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">async</span> <span class="k">def</span> <span class="nf">create_story</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                           <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                           <span class="n">wiki_id</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">,</span>
                           <span class="n">user_description</span><span class="p">,</span>  <span class="c1"># TODO: Decide what this is.</span>
                           <span class="n">summary</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                           <span class="n">section_id</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">,</span>
                           <span class="n">_id</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ObjectId</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <p>Adds a new story to the stories collection. A section for the story
should be created before calling this function, in which the
<code>section_id</code> is specified. <code>_id</code> is optional and if provided will
create the story with the given <code>_id</code>, rather than the generated BSON
ObjectId. Currently, statistics and settings are unimplemented.</p>
<p>Args:
    title: The title of the story.
    wiki_id: The unique ID of the associated wiki.
    user_description: A dict containing information of the story's
        owner. A user description contains a <code>user_id</code>, <code>name</code>, and
        <code>access_level</code>.</p>
<pre><code>    `user_description` args:
        user_id (ObjectId): The unique ID of the user.
        name (str): The name of the user.
        access_level (str): A description of the user's
            privileges in the story.
summary: A brief summary of the story.
section_id: The unique ID of the story's recursive section
    representation.
_id (ObjectId): `_id` is optional, but if provided will create a
    story with the provided ObjectId.
</code></pre>
<p>Returns:
    The ObjectId that is associated with the newly created story. If
    <code>_id</code> was provided, <code>_id</code> will be returned. Otherwise, a randomly
    generated BSON ObjectId will be returned.</p>
<p>TODO: Implement statistics and settings.
Inserts a new section to the sections collection.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">story</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span>      <span class="n">title</span><span class="p">,</span>
            <span class="s1">&#39;wiki_id&#39;</span><span class="p">:</span>    <span class="n">wiki_id</span><span class="p">,</span>
            <span class="s1">&#39;users&#39;</span><span class="p">:</span>      <span class="p">[</span><span class="n">user_description</span><span class="p">],</span>
            <span class="s1">&#39;summary&#39;</span><span class="p">:</span>    <span class="n">summary</span><span class="p">,</span>
            <span class="s1">&#39;section_id&#39;</span><span class="p">:</span> <span class="n">section_id</span><span class="p">,</span>
            <span class="s1">&#39;statistics&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s1">&#39;settings&#39;</span><span class="p">:</span>   <span class="bp">None</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">story</span><span class="p">[</span><span class="s1">&#39;_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_id</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">stories</span><span class="o">.</span><span class="n">insert_one</span><span class="p">(</span><span class="n">story</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">inserted_id</span>

    <span class="n">async</span> <span class="k">def</span> <span class="nf">create_section</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">_id</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ObjectId</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <p>Adds a new section to the sections collection. Sections are nodes in a
tree that represent a story. Each section can contain text (content) and
also sub-sections. As a leaf node, sections can be thought of as a
chapter. Pre-sections can be used to represent a prologue and
post-sections an epilogue. <code>_id</code> is optional, and if provided will add a
section to the collection with the given <code>_id</code>, otherwise a BSON
ObjectId will be generated in its place. Currently, statistics are not
implemented.</p>
<p>Args:
    title: The title of the section.
    _id (ObjectId): <code>_id</code> is optional, but if provided will create a
        section with the provided ObjectId.</p>
<p>Returns:
    The ObjectId that is associated with the newly created section. If
    <code>_id</code> was provided, <code>_id</code>, will be returned. Otherwise, the <code>_id</code>
    associated with the section will be returned.</p>
<p>TODO: Implement statistics.
Grabs the information associated with the provided story.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">section</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span>                  <span class="n">title</span><span class="p">,</span>
            <span class="s1">&#39;content&#39;</span><span class="p">:</span>                <span class="nb">list</span><span class="p">(),</span>  <span class="c1"># content is a list of &quot;paragraph objects&quot;</span>
            <span class="s1">&#39;preceding_subsections&#39;</span><span class="p">:</span>  <span class="nb">list</span><span class="p">(),</span>
            <span class="s1">&#39;inner_subsections&#39;</span><span class="p">:</span>      <span class="nb">list</span><span class="p">(),</span>
            <span class="s1">&#39;succeeding_subsections&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(),</span>
            <span class="s1">&#39;statistics&#39;</span><span class="p">:</span>             <span class="bp">None</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">section</span><span class="p">[</span><span class="s1">&#39;_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_id</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="o">.</span><span class="n">insert_one</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">inserted_id</span>

    <span class="n">async</span> <span class="k">def</span> <span class="nf">get_story</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">story_id</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <p>Finds the story in the database and returns the document.</p>
<p>Args:
    story_id: BSON ObjectId of story to query for.</p>
<p>Returns:
    A copy of the document of the story.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">result</span> <span class="o">=</span> <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">stories</span><span class="o">.</span><span class="n">find_one</span><span class="p">({</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="n">story_id</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="n">async</span> <span class="k">def</span> <span class="nf">get_section</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section_id</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <p>TODO: Add docstring</p>
<p>Args:
    section_id:</p>
<p>Returns:</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">result</span> <span class="o">=</span> <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="o">.</span><span class="n">find_one</span><span class="p">({</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="n">section_id</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">result</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <h6></h6>
<p>Wiki Methods</p>
<h6></h6>
<p>Inserts a new wiki to the wikis collection.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">async</span> <span class="k">def</span> <span class="nf">create_wiki</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">user_description</span><span class="p">,</span> <span class="n">summary</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">segment_id</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">,</span> <span class="n">_id</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ObjectId</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      <p>Adds a new wiki to the wikis collection. A segment for the wiki should
be created before calling this function, in which the <code>segment_id</code> is
specified. <code>_id</code> is optional and if provided will create the wiki with
the given <code>_id</code>, rather than the generated BSON ObjectId. Currently,
statistics and settings are unimplemented.</p>
<p>Args:
    title: The title of the wiki.
    user_description: A dict containing the information of the wiki's
        owner. A user description contains a <code>user_id</code>, <code>name</code>, and
        <code>access_level</code>.</p>
<pre><code>    `user_description` args:
        user_id (ObjectId): The unique ID of the user.
        name (str): The name of the user.
        access_level (str): A description of the user's privileges
        in the story.
summary: A brief summary of the the wiki.
segment_id: The unique ID of the wiki's recursive segment
    representation.
_id (ObjectId): `_id` is optional, but if provided will create a
    wiki with the provided ObjectId.
</code></pre>
<p>Returns:
    The ObjectId that is associated with the newly created wiki. If
    <code>_id</code> was provided, <code>_id</code> will be returned. Otherwise, a randomly
    generated BSON ObjectId will be returned.</p>
<p>TODO: Implement statistics and settings.
Inserts a new segment to the segments collection.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">wiki</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span>      <span class="n">title</span><span class="p">,</span>
            <span class="s1">&#39;users&#39;</span><span class="p">:</span>      <span class="p">[</span><span class="n">user_description</span><span class="p">],</span>
            <span class="s1">&#39;summary&#39;</span><span class="p">:</span>    <span class="n">summary</span><span class="p">,</span>
            <span class="s1">&#39;segment_id&#39;</span><span class="p">:</span> <span class="n">segment_id</span><span class="p">,</span>
            <span class="s1">&#39;statistics&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s1">&#39;settings&#39;</span><span class="p">:</span>   <span class="bp">None</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">wiki</span><span class="p">[</span><span class="s1">&#39;_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_id</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">wikis</span><span class="o">.</span><span class="n">insert_one</span><span class="p">(</span><span class="n">wiki</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">inserted_id</span>

    <span class="n">async</span> <span class="k">def</span> <span class="nf">create_segment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">_id</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ObjectId</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      <p>Adds a new segment to the segments collection. Segments are nodes in a
tree that represent a wiki. Each segment can contain sub-segments and
pages. Segments can be thought of as non-leaf nodes in the tree, where
pages are the leaf nodes. <code>template_headings</code> track headings that are
added to pages when pages are first created. Note, <code>template_headings</code>
only apply to pages directly under this segment. <code>_id</code> is optional, and
if provided will add a segment to the collection with the given <code>_id</code>,
otherwise a BSON ObjectId will be generated in its place. Currently,
statistics are not implemented.</p>
<p>Args:
    title: The title of the wiki segment.
    _id (ObjectId): <code>_id</code> is optional, but if provided will create a
        segment with the provided ObjectId.</p>
<p>Returns:
    The ObjectId that is associated with the newly created segment. If
    <code>_id</code> was provided, <code>_id</code>, will be returned. Otherwise, the <code>_id</code>
    associated with the segment will be returned.</p>
<p>TODO: Implement statistics. 
Inserts a new page to the pages collection.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">segment</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span>             <span class="n">title</span><span class="p">,</span>
            <span class="s1">&#39;segments&#39;</span><span class="p">:</span>          <span class="nb">list</span><span class="p">(),</span>
            <span class="s1">&#39;pages&#39;</span><span class="p">:</span>             <span class="nb">list</span><span class="p">(),</span>
            <span class="s1">&#39;template_headings&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(),</span>
            <span class="s1">&#39;statistics&#39;</span><span class="p">:</span>        <span class="bp">None</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">segment</span><span class="p">[</span><span class="s1">&#39;_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_id</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="o">.</span><span class="n">insert_one</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">inserted_id</span>

    <span class="n">async</span> <span class="k">def</span> <span class="nf">create_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">_id</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ObjectId</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <p>Adds a new page to the pages collection. Pages are leaf nodes in a tree
that represent a wiki. Each page contains <code>headings</code>, which hold the
content for a wiki page. <code>_id</code> is optional, and if provided will add a
page to the collection with the given <code>_id</code>, otherwise a BSON ObjectId
will be generated in its place. Currently, references and aliases are
not implemented.</p>
<p>Args:
    title: The title of the wiki page.
    _id (ObjectId): <code>_id</code> is optional, but if provided will create a
        page with the provided ObjectId.</p>
<p>Returns:
    The ObjectId that is associated with the newly created page. If
    <code>_id</code> was provided, <code>_id</code>, will be returned. Otherwise, the <code>_id</code>
    associated with the page will be returned.</p>
<p>TODO: Implement references and aliases.
Inserts a new heading to the headings collection.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">page</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span>      <span class="n">title</span><span class="p">,</span>
            <span class="s1">&#39;headings&#39;</span><span class="p">:</span>   <span class="nb">list</span><span class="p">(),</span>
            <span class="s1">&#39;references&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s1">&#39;aliases&#39;</span><span class="p">:</span>    <span class="bp">None</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">page</span><span class="p">[</span><span class="s1">&#39;_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_id</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="o">.</span><span class="n">insert_one</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">inserted_id</span>

    <span class="n">async</span> <span class="k">def</span> <span class="nf">create_heading</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">_id</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ObjectId</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      <p>Adds a new heading to the headings collection. Headings are text blocks
on a wiki page. For example, "Background" and "Motives" are considered
headings. <code>_id</code> is optional and if provided will create the heading
with the given <code>_id</code>, rather than the generated BSON ObjectID.</p>
<p>Args:
    title: The title of the heading.
    _id (ObjectId): <code>_id</code> is optional, but if provided will create a
        heading with the provided ObjectId.</p>
<p>Returns:
    The ObjectId that is associated with the newly created heading. If
    <code>_id</code> was provided, <code>_id</code> will be returned. Otherwise, a randomly
    generated BSON ObjectId will be returned.</p>
<p>Grabs the information associated with the provided wiki.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">heading</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span>   <span class="n">title</span><span class="p">,</span>
            <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(),</span>  <span class="c1"># content is a list of &quot;paragraph objects&quot;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">heading</span><span class="p">[</span><span class="s1">&#39;_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_id</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">headings</span><span class="o">.</span><span class="n">insert_one</span><span class="p">(</span><span class="n">heading</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">inserted_id</span>

    <span class="n">async</span> <span class="k">def</span> <span class="nf">get_wiki</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wiki_id</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      <p>Finds the wiki in the database and returns the document.</p>
<p>Args:
    wiki_id: BSON ObjectId of wiki to query for.</p>
<p>Returns:
    A copy of the document of the wiki.</p>
<p>Grabs the information associated with the provided segment.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">result</span> <span class="o">=</span> <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">wikis</span><span class="o">.</span><span class="n">find_one</span><span class="p">({</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="n">wiki_id</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="n">async</span> <span class="k">def</span> <span class="nf">get_segment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segment_id</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      <p>Finds the segment in the database and returns the document.</p>
<p>Args:
    segment_id: BSON ObjectId of segment to query for.</p>
<p>Returns:
    A copy of the document of the segment.</p>
<p>Grabs the information associated with the provided page.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">result</span> <span class="o">=</span> <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">segments</span><span class="o">.</span><span class="n">find_one</span><span class="p">({</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="n">segment_id</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="n">async</span> <span class="k">def</span> <span class="nf">get_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page_id</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      <p>Finds the page in the database and returns the document.</p>
<p>Args:
    page_id: BSON ObjectId of page to query for.</p>
<p>Returns:
    A copy of the document of the page.</p>
<p>Grabs the information associated with the provided heading.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">result</span> <span class="o">=</span> <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">pages</span><span class="o">.</span><span class="n">find_one</span><span class="p">({</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="n">page_id</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="n">async</span> <span class="k">def</span> <span class="nf">get_heading</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">heading_id</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      <p>Finds the heading int he database and returns the document.</p>
<p>Args:
    heading_id: BSON ObjectId of heading to query for.</p>
<p>Returns:
    A copy of the document of the heading.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">result</span> <span class="o">=</span> <span class="n">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">headings</span><span class="o">.</span><span class="n">find_one</span><span class="p">({</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="n">heading_id</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">result</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-26'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-26'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">class</span> <span class="nc">LoomMongoDBMotorTornadoClient</span><span class="p">(</span><span class="n">LoomMongoDBClient</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-27'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-27'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db_name</span><span class="o">=</span><span class="s1">&#39;inkweaver&#39;</span><span class="p">,</span> <span class="n">db_host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">db_port</span><span class="o">=</span><span class="mi">27017</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">motor.motor_tornado</span> <span class="kn">import</span> <span class="n">MotorClient</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">MotorClient</span><span class="p">,</span> <span class="n">db_name</span><span class="p">,</span> <span class="n">db_host</span><span class="p">,</span> <span class="n">db_port</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-28'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-28'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">class</span> <span class="nc">LoomMongoDBMotorAsyncioClient</span><span class="p">(</span><span class="n">LoomMongoDBClient</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-29'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-29'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db_name</span><span class="o">=</span><span class="s1">&#39;inkweaver&#39;</span><span class="p">,</span> <span class="n">db_host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">db_port</span><span class="o">=</span><span class="mi">27017</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">motor.motor_asyncio</span> <span class="kn">import</span> <span class="n">AsyncIOMotorClient</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">AsyncIOMotorClient</span><span class="p">,</span> <span class="n">db_name</span><span class="p">,</span> <span class="n">db_host</span><span class="p">,</span> <span class="n">db_port</span><span class="p">)</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
